#!/usr/bin/env bash
# This script updates /etc/hosts to remap localhost and facebook.com

HOSTS_FILE="/etc/hosts"
BACKUP_FILE="/etc/hosts.bak"

# Ensure the script is run as root
if [ "$EUID" -ne 0 ]; then
  echo "Please run as root: sudo ./0-change_your_home_IP"
  exit 1
fi

echo "Backing up original hosts file to $BACKUP_FILE..."
cp "$HOSTS_FILE" "$BACKUP_FILE"

echo "Removing existing localhost and facebook.com entries..."
# Remove existing localhost and facebook.com entries
sed -i '/127\.0\.0\.1[[:space:]]\+localhost/d' "$HOSTS_FILE"
sed -i '/facebook\.com/d' "$HOSTS_FILE"

echo "Adding new entries..."
# Add new mappings
echo "127.0.0.2 localhost" >> "$HOSTS_FILE"
echo "8.8.8.8 facebook.com" >> "$HOSTS_FILE"

echo "Done! Here's the updated section:"
grep -E 'localhost|facebook\.com' "$HOSTS_FILE"
